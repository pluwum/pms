# Developed features

1. Read, Create, update and delete a booking
2. Read, Create, update and delete a parking slot
3. Read, Create and delete a user
4. Authentication with api-key passed in header

### Booking Management

This feature allows admin and standard users to manage parking slot bookings.
For each parking slot booking the following rules have been implemented.

-   Booking Start date and time of booking cannot be in the past.
-   Slot being booked cannot have an overlapping booking.
-   Bookings can only be updated by the creator or and admin user.

-   [Booking entity](../api/booking/booking.entity.ts)

### Parking slot Management

This feature allows an admin user to manage creation and update of parking slots.
For each parking slot the following rules have been implemented.

-   Only admins have access to this functionality
-   Parking slots are considered to be in an ACTIVE status by default.
-   ACTIVE/INACTIVE states of a parking slots denote the availability of the parking slot for booking/use.
-   Status reason field, allows admin to add additional information about the state of the parking slot.

-   [Parking Slot entity](../api/parking-slot/parking-slot.entity.ts)

### Authentication

-   Authentication is via api-token or x-api-token field passed in the headers.
-   Token is autogenerated when user is created or can be provided with user creation payload.
-   Verification of this token is performed via middleware. Each route is given an `authenticate` boolean which instructs the middleware on when to authenticate.
-   routes with declared as `authenticate: false` are not checked by middleware for api-tokens. These are regarded as open routes.

### Authorisation

-   Authorisation is available on two levels
    -   Route level - routes declared `permissions: ["admin", "standard"]` will accept access with tokens associated with an admin role or standard user role.
    -   Operation level - actions like booking have operation level checks, role information from HTTP request context is used to filter and protect database objects from authorised access or manipulation.

### User Management

-   Is not protected.
-   Was given minimal effort as it was not priority for this task.

# Design Patterns / Project structure

-   Folder structure is inspired by a mixture of clean architecture, layered architecture and vertical slice
-   The project evolved into this pattern as complexity increased. This arrangement ensures minimal change to several files when adding features, simplifies testing and discoverability.

# Tech stack

-   Typescript - Because it is the language i'm most comfortable with at the moment.
-   Express - for it's light weight nature and ease of setup. It was either express or flask
-   TypeOrm - for it's sqlite in memory database, support for entities, repositories and migrations, this makes
-   Sqlite - For it's light weight nature and ease of setup. I deliberately chose this so I don't have to install specialised database system to start developing the application locally. However, the abstraction provided by the ORM allows us to swap this when the time comes for production deployment.

# What I would do given more time.

-   Dockerize the application
-   Swap database engine for postgres.
-   Additional validation for bookings
-   Validation for user endpoints
-   Unit tests for the service logic in \*.service.ts files
-   Integration tests covering more edge cases. Currently even the validations rules are not tested.
-   Provide commands to generate seed data.
-   Limit the number of bookings a standard user is able to make on a given day.
-   Improve typescript typing throughout the codebase. There is high reliance on implicit types, some parts of the code are not typed at all.
-   Before booking a parking slot, validate that booking slot is not INACTIVE
-   Complete openAPI documentation - Examples of payload are not provided, security warnings are seen when an api audit is performed, the current implementation of api docs puts the project at risk of spec-drift.
-   Enforce a minimum length requirement for user token
